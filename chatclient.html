<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‚ò† FINAL BOSS ‚ò†</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Nosifer&family=Orbitron:wght@500&family=Roboto+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        min-height: 100vh;
        background: radial-gradient(circle at center, #1a0000 0%, #000 70%);
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Roboto Mono", monospace;
        color: #eee;
      }

      /* CRT */
      body::after {
        content: "";
        position: fixed;
        inset: 0;
        background: repeating-linear-gradient(
          to bottom,
          rgba(255, 255, 255, 0.03),
          rgba(255, 255, 255, 0.03) 1px,
          transparent 1px,
          transparent 3px
        );
        pointer-events: none;
        animation: crt 3s infinite;
      }

      /* FOG */
      body::before {
        content: "";
        position: fixed;
        inset: -200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.03),
          transparent 60%
        );
        animation: fog 120s linear infinite;
        pointer-events: none;
      }

      /* EYES */
      .eye {
        position: fixed;
        font-size: 22px;
        opacity: 0.25;
        transition: transform 0.15s linear;
      }
      .eye:nth-child(1) {
        top: 10%;
        left: 8%;
      }
      .eye:nth-child(2) {
        top: 20%;
        right: 10%;
      }
      .eye:nth-child(3) {
        bottom: 18%;
        left: 14%;
      }
      .eye:nth-child(4) {
        bottom: 16%;
        right: 12%;
      }

      /* TERMINAL */
      form {
        width: 420px;
        max-width: 95%;
        height: 620px;
        background: rgba(0, 0, 0, 0.94);
        border: 1px solid rgba(255, 0, 0, 0.7);
        box-shadow: 0 0 50px rgba(255, 0, 0, 0.6),
          inset 0 0 30px rgba(255, 0, 0, 0.35);
        border-radius: 6px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        animation: flicker 6s infinite;
      }

      form::before {
        content: "‚ò† CHAT FROM THE ABYSS ‚ò†";
        font-family: "Nosifer", cursive;
        text-align: center;
        padding: 16px;
        font-size: 1.05rem;
        background: #080000;
        color: #ff1e1e;
        border-bottom: 1px solid #ff1e1e;
        text-shadow: 0 0 22px red;
      }

      /* MESSAGES */
      #messages {
        flex: 1;
        list-style: none;
        padding: 18px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      #messages li {
        position: relative;
        max-width: 80%;
        padding: 12px;
        background: linear-gradient(145deg, #050000, #160000);
        border-left: 4px solid red;
        font-size: 0.85rem;
        box-shadow: 0 0 22px rgba(255, 0, 0, 0.55);
        animation: haunt 0.4s ease, shake 3s infinite;
      }
      #messages li::after {
        content: "";
        position: absolute;
        left: 10px;
        top: 100%;
        width: 4px;
        height: 0;
        background: crimson;
        animation: drip 5s infinite;
      }

      /* HIDE SCROLLBAR BUT KEEP SCROLL */
      #messages {
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE / Edge */
      }

      #messages::-webkit-scrollbar {
        display: none; /* Chrome / Safari */
      }

      /* INPUT */
      #m {
        margin: 14px;
        padding: 14px;
        background: #000;
        border: 1px solid red;
        color: #fff;
        outline: none;
      }
      #m:focus {
        box-shadow: 0 0 18px red;
      }

      /* BUTTON */
      button {
        margin: 0 14px 18px;
        padding: 12px;
        background: #100000;
        border: 1px solid red;
        color: red;
        font-family: "Orbitron", sans-serif;
        letter-spacing: 2px;
        cursor: pointer;
      }
      button:hover {
        background: red;
        color: black;
        box-shadow: 0 0 30px red;
      }

      /* OVERLAYS */
      #jump,
      #lock {
        position: fixed;
        inset: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Nosifer", cursive;
        font-size: 1.6rem;
        letter-spacing: 2px;
        color: red;
        pointer-events: none;
        opacity: 0;
        z-index: 9999;
      }
      #jump {
        background: radial-gradient(
          circle,
          rgba(255, 0, 0, 0.7),
          rgba(0, 0, 0, 0.95) 60%
        );
      }
      #lock {
        background: rgba(0, 0, 0, 0.9);
      }

      .corrupt {
        filter: hue-rotate(180deg) contrast(1.5) saturate(1.6);
        animation: corrupt 1.2s infinite;
      }

      /* ANIMATIONS */
      @keyframes flicker {
        0%,
        100% {
          opacity: 1;
        }
        95% {
          opacity: 0.85;
        }
      }
      @keyframes haunt {
        from {
          opacity: 0;
          transform: translateX(-14px);
        }
        to {
          opacity: 1;
        }
      }
      @keyframes shake {
        96% {
          transform: translate(1px, -1px);
        }
        98% {
          transform: translate(-1px, 1px);
        }
      }
      @keyframes drip {
        0% {
          height: 0;
        }
        40% {
          height: 26px;
        }
        100% {
          height: 50px;
          opacity: 0;
        }
      }
      @keyframes fog {
        to {
          transform: translate(50%, 50%);
        }
      }
      @keyframes crt {
        50% {
          opacity: 0.35;
        }
      }
      @keyframes corrupt {
        50% {
          filter: hue-rotate(300deg) blur(1px);
        }
      }

      @media (max-width: 480px) {
        form {
          height: 100vh;
          border-radius: 0;
        }
      }
    </style>
  </head>

  <body>
    <!-- WATCHING EYES -->
    <div class="eye">üëÅ</div>
    <div class="eye">üëÅ</div>
    <div class="eye">üëÅ</div>
    <div class="eye">üëÅ</div>

    <div id="jump">RUN</div>
    <div id="lock">YOU ARE NOT ALONE</div>

    <form id="terminal">
      <input id="m" placeholder="It hears you..." />
      <button type="button" onclick="sendmsg()">SUMMON</button>
      <ul id="messages"></ul>
    </form>

    <!-- AUDIO -->
    <audio id="demon" preload="auto">
      <source
        src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA="
      />
    </audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();
      const demon = document.getElementById("demon");
      const jump = document.getElementById("jump");
      const lock = document.getElementById("lock");
      const terminal = document.getElementById("terminal");
      const eyes = document.querySelectorAll(".eye");

      let corruption = 0;
      let audioUnlocked = false;

      /* AUDIO UNLOCK */
      function unlockAudio() {
        if (audioUnlocked) return;
        demon.volume = 0.5;
        demon
          .play()
          .then(() => {
            demon.pause();
            demon.currentTime = 0;
            audioUnlocked = true;
            console.log("üîä Audio unlocked");
          })
          .catch(() => {});
      }
      document.addEventListener("click", unlockAudio);
      document.addEventListener("keydown", unlockAudio);

      /* EYES FOLLOW CURSOR */
      document.addEventListener("mousemove", (e) => {
        eyes.forEach((eye) => {
          const r = eye.getBoundingClientRect();
          eye.style.transform = `translate(${(e.clientX - r.left) / 30}px,${
            (e.clientY - r.top) / 30
          }px)`;
        });
      });

      function jumpscare() {
        jump.style.opacity = 1;
        setTimeout(() => (jump.style.opacity = 0), 600);
      }
      function possession() {
        lock.style.opacity = 1;
        setTimeout(() => (lock.style.opacity = 0), 1600);
      }

      function sendmsg() {
        const i = document.getElementById("m");
        if (!i.value.trim()) return;
        socket.emit("chatmessage", i.value);
        i.value = "";
      }

      socket.on("chatmessage", (msg) => {
        const li = document.createElement("li");
        li.innerText = msg;
        messages.appendChild(li);

        if (audioUnlocked) {
          demon.currentTime = 0;
          demon.play().catch(() => {});
        }

        if (msg.length > 40) {
          corruption++;
          terminal.classList.add("bleed");
          setTimeout(() => terminal.classList.remove("bleed"), 1200);
        }

        if (corruption >= 3) {
          terminal.classList.add("corrupt");
        }

        if (Math.random() < 0.05) jumpscare();
        if (Math.random() < 0.03) possession();
      });
    </script>
  </body>
</html>
